!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ConfettiGenerator=t()}(this,function(){"use strict";return function(e){var n={target:"confetti-holder",max:80,size:1,animate:!0,respawn:!0,props:["circle","square","triangle","line"],colors:[[165,104,246],[230,61,135],[0,199,228],[253,214,126]],clock:25,interval:null,rotate:!1,start_from_edge:!1,width:window.innerWidth,height:window.innerHeight,fps:17};if(e&&(e.target&&(n.target=e.target),e.max&&(n.max=e.max),e.size&&(n.size=e.size),null!=e.animate&&(n.animate=e.animate),null!=e.respawn&&(n.respawn=e.respawn),e.props&&(n.props=e.props),e.colors&&(n.colors=e.colors),e.clock&&(n.clock=e.clock),null!=e.start_from_edge&&(n.start_from_edge=e.start_from_edge),e.width&&(n.width=e.width),e.height&&(n.height=e.height),null!=e.rotate&&(n.rotate=e.rotate),e.fps&&(n.fps=0|Math.round(1e3/e.fps))),"object"!=typeof n.target&&"string"!=typeof n.target)throw new TypeError("The target parameter should be a node or string");if("object"==typeof n.target&&(null===n.target||!n.target instanceof HTMLCanvasElement)||"string"==typeof n.target&&(null===document.getElementById(n.target)||!document.getElementById(n.target)instanceof HTMLCanvasElement))throw new ReferenceError("The target element does not exist or is not a canvas element");var t="object"==typeof n.target?n.target:document.getElementById(n.target),a=t.getContext("2d"),i=[],r=n.props.filter(function(e){return e&&e.type&&"svg"===e.type}),o={};if(r)for(var s=0;s<r.length;s++){var l=new window.Image;l.src=r[s].src,o[r[s].src]=l}function c(e,t){e=e||1;var r=Math.random()*e;return t?Math.floor(r):r}var h=n.props.reduce(function(e,t){return e+(t.weight||1)},0);function f(){var e=n.props[function(){for(var e=Math.random()*h,t=0;t<n.props.length;++t){var r=n.props[t].weight||1;if(e<r)return t;e-=r}}()];return{prop:e.type?e.type:e,x:c(n.width),y:n.start_from_edge?n.clock<0?parseFloat(n.height)+10:-10:c(n.height),src:e.src,radius:c(4)+1,size:e.size,rotate:n.rotate,line:Math.floor(c(65)-30),angles:[c(10,!0)+2,c(10,!0)+2,c(10,!0)+2,c(10,!0)+2],color:n.colors[c(n.colors.length,!0)],rotation:c(360,!0)*Math.PI/180,speed:c(n.clock/7)+n.clock/30}}function g(e){if(e)switch(a.fillStyle=a.strokeStyle="rgba("+e.color+", "+(3<e.radius?.8:.4)+")",a.beginPath(),e.prop){case"circle":a.moveTo(e.x,e.y),a.arc(e.x,e.y,e.radius*n.size,0,2*Math.PI,!0),a.fill();break;case"triangle":a.moveTo(e.x,e.y),a.lineTo(e.x+e.angles[0]*n.size,e.y+e.angles[1]*n.size),a.lineTo(e.x+e.angles[2]*n.size,e.y+e.angles[3]*n.size),a.closePath(),a.fill();break;case"line":a.moveTo(e.x,e.y),a.lineTo(e.x+e.line*n.size,e.y+5*e.radius),a.lineWidth=2*n.size,a.stroke();break;case"square":a.save(),a.translate(e.x+15,e.y+5),a.rotate(e.rotation),a.fillRect(-15*n.size,-5*n.size,15*n.size,5*n.size),a.restore();break;case"svg":a.save();var t=o[e.src],r=e.size||15;a.translate(e.x+r/2,e.y+r/2),e.rotate&&a.rotate(e.rotation),a.drawImage(t,-r/2*n.size,-r/2*n.size,r*n.size,r*n.size),a.restore()}}function d(){n.animate=!1,clearInterval(n.interval),requestAnimationFrame(function(){a.clearRect(0,0,t.width,t.height);var e=t.width;t.width=1,t.width=e})}return{render:function(){t.width=n.width,t.height=n.height,i=[],o.last=(new Date).getTime();for(var e=0;e<n.max;e++)i.push(f());function o(){for(var e=(new Date).getTime(),t=e-o.last,r=0;r<n.max;r++){var a=i[r];a&&(n.animate&&(a.y+=a.speed*(t/20)),a.rotate&&(a.rotation+=a.speed/35*(t/20)),(0<=a.speed&&n.height<a.y||a.speed<0&&a.y<0)&&(n.respawn?(i[r]=a,i[r].x=c(n.width,!0),i[r].y=a.speed<0?parseFloat(n.height):-10):i[r]=void 0)),o.last=e}i.every(function(e){return void 0===e})&&d()}return requestAnimationFrame(function e(){for(var t in a.clearRect(0,0,n.width,n.height),i)g(i[t]);o(),n.animate&&setTimeout(function(){requestAnimationFrame(e)},n.fps)})},clear:d}}});
